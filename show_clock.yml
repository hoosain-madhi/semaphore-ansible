---
- name: Get Clock Time from AsterNOS Switch
  hosts: asterfusion_switches
  gather_facts: no

  tasks:
    - name: Get clock (sonic-cli, non-interactive)
      ansible.builtin.raw: |
        timeout 20 sh -lc "(echo 'show clock'; yes '' | head -n 10; echo 'exit') | sonic-cli"
      register: clock_output
      changed_when: false
      failed_when: false
      check_mode: false

    - name: Display the clock output
      ansible.builtin.debug:
        msg: "{{ clock_output.stdout | default('NO OUTPUT') | trim }}"
