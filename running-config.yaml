---
- name: Show running-config on AsterNOS
  hosts: asterfusion_switches
  gather_facts: no

  tasks:
    - name: Sanity - show who we are running on
      ansible.builtin.debug:
        msg: "Running on {{ inventory_hostname }} (groups={{ group_names }})"

    - name: Get running-config
      ansible.builtin.raw: |
        sonic-cli <<'EOF'
        show running-config
        EOF
      register: rc
      changed_when: false
      failed_when: false

    - name: Display running-config (only if we got output)
      ansible.builtin.debug:
        msg: "{{ rc.stdout | default('NO OUTPUT (command may not have run)') }}"
